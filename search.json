[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Présentations codification automatique de l'APE",
    "section": "",
    "text": "Tous les supports sont accessibles et modifiables sur Github InseeFrLab \n\n\n\n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Séminaire interne du département des méthodes statistiques de l'Insee\n\n            \n\n            \n            \n              \n                Thomas Faria et Tom Seimandi\n                Sep 1, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation lors de l'évènement de lancement du SSP Hub\n\n            \n\n            \n            \n              \n                Thomas Faria et Tom Seimandi\n                Apr 17, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Presentation given during the UNECE Machine Learning for Official Statistics Workshop 2023\n\n            \n\n            \n            \n              \n                Thomas Faria and Tom Seimandi\n                Jun 5, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation pour la formation Big Data donné à la BCEAO à Dakar\n\n            \n\n            \n            \n              \n                Romain Avouac, Thomas Faria et Tom Seimandi\n                Sep 27, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Slides used for an exchange with StatCan on MLOps\n\n            \n\n            \n            \n              \n                Romain Avouac, Thomas Faria et Tom Seimandi\n                Mar 19, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Presentation given during the NACE implementation webinar\n\n            \n\n            \n            \n              \n                Nathan Randriamanana\n                Apr 30, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Codification automatique de l'APE à l'Insee\n\n            \n\n            \n            \n              \n                Thomas Faria et Nathan Randriamanana\n                May 7, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Retraining strategies for an economic activity classification model\n\n            \n\n            \n            \n              \n                Thomas Faria, Nathan Randriamanana, Tom Seimandi\n                May 24, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n                \n                  \n                    \n                      \n                        Paper\n                      \n                    \n                  \n                \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025\n\n            \n\n            \n            \n              \n                Thomas Faria, Nathan Randriamanana\n                Nov 6, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation du package torchFastText et ses performances sur la codification de l'APE\n\n            \n\n            \n            \n              \n                Meilame Tayebjee\n                Mar 5, 2025\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation non technique de la codification automatique de la NAF\n\n            \n\n            \n            \n              \n                Meilame Tayebjee\n                Apr 4, 2025\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Presentation given during the UNECE Generative AI and Official Statistics Workshop 2025\n\n            \n\n            \n            \n              \n                Thomas Faria\n                May 12, 2025\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#présentations-relatives-à-la-codification-automatique-de-lape",
    "href": "index.html#présentations-relatives-à-la-codification-automatique-de-lape",
    "title": "Présentations codification automatique de l'APE",
    "section": "",
    "text": "Tous les supports sont accessibles et modifiables sur Github InseeFrLab \n\n\n\n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Séminaire interne du département des méthodes statistiques de l'Insee\n\n            \n\n            \n            \n              \n                Thomas Faria et Tom Seimandi\n                Sep 1, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation lors de l'évènement de lancement du SSP Hub\n\n            \n\n            \n            \n              \n                Thomas Faria et Tom Seimandi\n                Apr 17, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Presentation given during the UNECE Machine Learning for Official Statistics Workshop 2023\n\n            \n\n            \n            \n              \n                Thomas Faria and Tom Seimandi\n                Jun 5, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation pour la formation Big Data donné à la BCEAO à Dakar\n\n            \n\n            \n            \n              \n                Romain Avouac, Thomas Faria et Tom Seimandi\n                Sep 27, 2023\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Slides used for an exchange with StatCan on MLOps\n\n            \n\n            \n            \n              \n                Romain Avouac, Thomas Faria et Tom Seimandi\n                Mar 19, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Presentation given during the NACE implementation webinar\n\n            \n\n            \n            \n              \n                Nathan Randriamanana\n                Apr 30, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Codification automatique de l'APE à l'Insee\n\n            \n\n            \n            \n              \n                Thomas Faria et Nathan Randriamanana\n                May 7, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Retraining strategies for an economic activity classification model\n\n            \n\n            \n            \n              \n                Thomas Faria, Nathan Randriamanana, Tom Seimandi\n                May 24, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n                \n                  \n                    \n                      \n                        Paper\n                      \n                    \n                  \n                \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025\n\n            \n\n            \n            \n              \n                Thomas Faria, Nathan Randriamanana\n                Nov 6, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation du package torchFastText et ses performances sur la codification de l'APE\n\n            \n\n            \n            \n              \n                Meilame Tayebjee\n                Mar 5, 2025\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Présentation non technique de la codification automatique de la NAF\n\n            \n\n            \n            \n              \n                Meilame Tayebjee\n                Apr 4, 2025\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            \n            \n\n            \n              Description : Presentation given during the UNECE Generative AI and Official Statistics Workshop 2025\n\n            \n\n            \n            \n              \n                Thomas Faria\n                May 12, 2025\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        Slides\n                      \n                    \n                  \n                \n              \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n\n\nNo matching items"
  },
  {
    "objectID": "slides/unece-2025/index.html#ml-model-robustness",
    "href": "slides/unece-2025/index.html#ml-model-robustness",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "ML Model Robustness",
    "text": "ML Model Robustness\n\nML models are trained using reference datasets tailored for a specific task.\nIn practice, real-world data often drifts over time from these reference datasets ➡️ performance degradation?\nRegular retraining becomes essential.\nA particularly challenging case in official statistics is the change in the classification."
  },
  {
    "objectID": "slides/unece-2025/index.html#timeline-for-adoption",
    "href": "slides/unece-2025/index.html#timeline-for-adoption",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Timeline for Adoption 🗓️",
    "text": "Timeline for Adoption 🗓️\n\nPhased adoption approach:\n2025 ➡️ dual labeling in both NACE Rév. 2 and 2.1\n2026 ➡️ improving the NACE Rév. 2.1. classifier model\n2027 ➡️ full NACE Rév. 2.1 classification while maintaining legacy NACE Rév. 2 codes for specific usages."
  },
  {
    "objectID": "slides/unece-2025/index.html#whats-new-in-nace-rév.-2.1",
    "href": "slides/unece-2025/index.html#whats-new-in-nace-rév.-2.1",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "What’s New in NACE Rév. 2.1?",
    "text": "What’s New in NACE Rév. 2.1?\n\nAt level 5: 746 sub-classes compared to 732 before.\nMainly fine-grained splits at class level (level 4), but not exclusively.\n551 unambiguous mappings, i.e., one-to-one correspondence ➡️ ideal case! 👌"
  },
  {
    "objectID": "slides/unece-2025/index.html#ambiguous-cases",
    "href": "slides/unece-2025/index.html#ambiguous-cases",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Ambiguous Cases",
    "text": "Ambiguous Cases\n\n181 ambiguous mappings, i.e., one-to-many ➡️ challenging! 🚩\nRequires expert review for proper recoding.\n\n\n\n\nShow distribution of ambiguous codes\n\n\n\n\n1-to-N\n# occurence\n\n\n\n\n2\n109\n\n\n3\n30\n\n\n4\n24\n\n\n5\n6\n\n\n6\n4\n\n\n8\n1\n\n\n9\n2\n\n\n21\n1\n\n\n27\n1\n\n\n36\n1\n\n\n38\n2"
  },
  {
    "objectID": "slides/unece-2025/index.html#multiple-challenges",
    "href": "slides/unece-2025/index.html#multiple-challenges",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Multiple Challenges",
    "text": "Multiple Challenges\n\nNeed to recode the stock of the registry forms ➡️ over 14 million entries.\nBuilding a classifier for new data flow requires a clean stock base as a training dataset.\nPrevious fastText model trained on over 10 million labeled entries.\nPerformance is highly sensitive to training data volume."
  },
  {
    "objectID": "slides/unece-2025/index.html#available-data",
    "href": "slides/unece-2025/index.html#available-data",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Available Data",
    "text": "Available Data\n\nOld registry dataset: \\(~10\\) million entries, but poorly suited for new labels.\nNew registry dataset: \\(~2.7\\) million entries.\n\nUnambiguous: \\(1.3\\) million, covering 504 sub-classes.\nAmbiguous: \\(1.4\\) million, covering 177 sub-classes.\n\nManual annotation campaign is critical."
  },
  {
    "objectID": "slides/unece-2025/index.html#annotation-campaign",
    "href": "slides/unece-2025/index.html#annotation-campaign",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Annotation Campaign",
    "text": "Annotation Campaign\n\nAnnotation launched since mid-2024.\nFocused on uniquely ambiguous cases.\n🎯 Dual objectives:\n\nAssign a NACE Rév. 2.1 code 🚀\nAssess NACE Rév. 2 code quality 🗸\nCurrent count: \\(~27k\\) annotated entries… still insufficient!"
  },
  {
    "objectID": "slides/unece-2025/index.html#methodology",
    "href": "slides/unece-2025/index.html#methodology",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Methodology",
    "text": "Methodology\n\n🎯 Goal: Build the most comprehensive training dataset possible.\nOne-shot experimentation ➡️ not intended for production reproducibility.\nLeveraging LLMs for automated NACE Rév. 2.1 labeling.\nData used:\n\nNew registry stock dataset (\\(~2.7M\\) records)\nMapping table from NACE experts\nNACE explanatory notes\nManually annotated data (\\(~27k\\) entries)"
  },
  {
    "objectID": "slides/unece-2025/index.html#methodology-1",
    "href": "slides/unece-2025/index.html#methodology-1",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Methodology",
    "text": "Methodology"
  },
  {
    "objectID": "slides/unece-2025/index.html#leveraging-llms",
    "href": "slides/unece-2025/index.html#leveraging-llms",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Leveraging LLMs",
    "text": "Leveraging LLMs\n\nAugmented Generation (RAG/CAG) vs fine-tunning\n\n\nRAG: Unstructured prior knowledge based on similarity of notes embeddings\nCAG: Structured prior knowledge based on known mappings\n\n\n💡 Core idea ➡️ Provide key information to the LLM to translate NACE Rév. 2 into 2.1\n\n\n\n\n\n\n\nWarning\n\n\nRAG can act like a zero-shot classifier, while CAG is not a classifier as it relies on prior knowledge."
  },
  {
    "objectID": "slides/unece-2025/index.html#prompt-design",
    "href": "slides/unece-2025/index.html#prompt-design",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Prompt Design",
    "text": "Prompt Design\n\nA common system prompt for all entries\n\n\nAfficher le prompt sytème\n\nTu es un expert de la Nomenclature statistique des Activités économiques dans la Communauté Européenne (NACE). Tu es chargé de réaliser le changement de nomenclature. Ta mission consiste à attribuer un code NACE 2025 à une entreprise, en t'appuyant sur le descriptif de son activité et à partir d'une liste de codes proposés (identifiée à partir de son code NACE 2008 existant). Voici les instructions à suivre:\n1. Analyse la description de l'activité principale de l'entreprise et le code NACE 2008 fourni par l'utilisateur.\n2. À partir de la liste des codes NACE 2025 disponible, identifie la catégorie la plus appropriée qui correspond à l'activité principale de l'entreprise.\n3. Retourne le code NACE 2025 au format JSON comme spécifié par l'utilisateur. Si la description de l'activité de l'entreprise n'est pas suffisamment précise pour identifier un code NACE 2025 adéquat, retourne `null` dans le JSON.\n4. Évalue la cohérence entre le code NACE 2008 fourni et la description de l'activité de l'entreprise. Si le code NACE 2008 ne semble pas correspondre à cette description, retourne `False` dans le champ `nace08_valid` du JSON. Note que si tu arrives à classer la description de l'activité de l'entreprise dans un code NACE 2025, le champ `nace08_valid` devrait `True`, sinon il y a incohérence.\n5. Réponds seulement avec le JSON complété aucune autres information ne doit être retourné.\n\nEach observation gets a custom prompt including:\n\nBusiness activity description\nOriginal NACE Rév. 2 code (in CAG)\nCandidate codes list from retriever\n\nInstruction on output format required."
  },
  {
    "objectID": "slides/unece-2025/index.html#output-validation",
    "href": "slides/unece-2025/index.html#output-validation",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Output Validation",
    "text": "Output Validation\n\nLLMs tend to be overly verbose\nResponses shaped into structured, minimal format\nJSON is the preferred schema.\n\n\n\nShow expected response format\n\n{\n    \"codable\": true,\n    \"nace_2008_valid\": true,\n    \"nace2025\": \"0147J\" \n}\n\n\nResponse parsing:\n\nFormat check\nDetecting hallucinations"
  },
  {
    "objectID": "slides/unece-2025/index.html#evaluation-challenge",
    "href": "slides/unece-2025/index.html#evaluation-challenge",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Evaluation Challenge",
    "text": "Evaluation Challenge\n\n❓ Key question: How to evaluate an LLM?:\nClassification seems simpler… but complexity of taxonomy matters.\nUsed \\(27k\\) manual annotations as the benchmark 🥇\n3 performance metrics:\n\nOverall accuracy\nAccuracy among codable entries\nAccuracy of LLM-only decisions"
  },
  {
    "objectID": "slides/unece-2025/index.html#performance-of-models",
    "href": "slides/unece-2025/index.html#performance-of-models",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Performance of models",
    "text": "Performance of models"
  },
  {
    "objectID": "slides/unece-2025/index.html#reconstructing-ambiguous-dataset",
    "href": "slides/unece-2025/index.html#reconstructing-ambiguous-dataset",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Reconstructing Ambiguous Dataset",
    "text": "Reconstructing Ambiguous Dataset\n\n💡Idea: Treat LLMs as additional annotators\n❓Can we boost performance via ensemble methods?\nBuilt 3 more annotations:\n\n\nCascade selection\nMajority vote\nWeighted vote"
  },
  {
    "objectID": "slides/unece-2025/index.html#annotation-fusion",
    "href": "slides/unece-2025/index.html#annotation-fusion",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Annotation Fusion",
    "text": "Annotation Fusion"
  },
  {
    "objectID": "slides/unece-2025/index.html#retraining-with-nace-rév.-2.1",
    "href": "slides/unece-2025/index.html#retraining-with-nace-rév.-2.1",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Retraining with NACE Rév. 2.1",
    "text": "Retraining with NACE Rév. 2.1\n\nRebuilt new registry dataset with NACE Rév. 2.1 (~2M records)\nData distribution unchanged\nNew registry variables used\nAchieved comparable performance to NACE Rév. 2 model"
  },
  {
    "objectID": "slides/unece-2025/index.html#retraining-accuracy",
    "href": "slides/unece-2025/index.html#retraining-accuracy",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "Retraining Accuracy",
    "text": "Retraining Accuracy"
  },
  {
    "objectID": "slides/unece-2025/index.html#the-nace-rév.-2.1-model",
    "href": "slides/unece-2025/index.html#the-nace-rév.-2.1-model",
    "title": "NACE Rév. 2.1 update: Retraining an ML model in production using LLM",
    "section": "The NACE Rév. 2.1 Model",
    "text": "The NACE Rév. 2.1 Model\n\nviewof activite = Inputs.text(\n  {label: '', value: 'coiffeur', width: 800}\n)\n\nurlApe = `https://codification-ape-dev.lab.sspcloud.fr/predict?description_activity=${activite}%20&type_form=X&event=01P&nb_echos_max=3&prob_min=0.0009`\n\nd3.json(urlApe).then( res =&gt; {\n  var IC, results;\n  ( {IC, ...results} = res )\n\n  IC = parseFloat(IC)\n\n  const rows = Object.values(results).map( obj =&gt; {\n    return `\n    &lt;tr&gt;\n      &lt;td&gt;${obj.code} | ${obj.libelle}&lt;/td&gt;\n      &lt;td&gt;${obj.probabilite.toFixed(3)}&lt;/td&gt;\n    &lt;/tr&gt;\n  `\n  }).join('')\n  \n  return html`\n  &lt;table&gt;\n    &lt;caption&gt;\n      Confidence index: ${IC.toFixed(3)}\n    &lt;/caption&gt;\n    &lt;tr&gt;\n      &lt;th style=\"text-align:center;\"&gt;Description (NACE Rév. 2.1)&lt;/th&gt;\n      &lt;th&gt;Probabilité&lt;/th&gt;\n    &lt;/tr&gt;\n      ${rows}\n  &lt;/table&gt;`\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { debounce } from \"@mbostock/debouncing-input\""
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#les-modèles-de-ml-en-production",
    "href": "slides/grp-veille-codif-auto-9/index.html#les-modèles-de-ml-en-production",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Les modèles de ML en production",
    "text": "Les modèles de ML en production\n\nDe plus en plus de modèle ML sont voués à être mis en production à l’Insee\nMultiples cas d’usages : codification automatique, imputation, détection de valeurs extrêmes\n\n\n\n\nQuality Assurance Framework of the European Statistical System\n\n\nSource data, integrated data, intermediate results and statistical outputs must be regularly assessed and validated.\n\n\n\n\nCela s’applique évidemment aux modèles de ML dans le processus de production statistique ➡️ besoin de maintenance dans le temps"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#qualité-des-modèles-ml",
    "href": "slides/grp-veille-codif-auto-9/index.html#qualité-des-modèles-ml",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Qualité des modèles ML",
    "text": "Qualité des modèles ML\n\nUn modèle ML est entrainé pour résoudre un tâche à partir de données de référence\nDonnées réelles peuvent dévier de ces données de références dans le temps ➡️ perte de performance ?\nRé-entrainement du modèle devient nécessaire\nCas extrême courant dans le cas de la statistique publique ➡️ changement de nomenclature"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#historique-du-projet-ape",
    "href": "slides/grp-veille-codif-auto-9/index.html#historique-du-projet-ape",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Historique du projet APE",
    "text": "Historique du projet APE\n\nEté 2022 : entraînement d’un modèle fasttext sur les données Sirene 3\nNovembre 2022 : 1ère mise en production (partielle) d’un modèle ML.\nJanvier 2023 : Prise en compte des valideurs dans Sirene 4 : éligibilité de l’activité du déclarant (CMA,…)\nMai 2023 : 1er ré-entrainement pour corriger un problème de classification\nMars 2024 : Toutes les liasses passent par fasttext. Complète bascule de Sirene 3 à 4\nEt maintenant ?"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#enjeux-actuels",
    "href": "slides/grp-veille-codif-auto-9/index.html#enjeux-actuels",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Enjeux actuels",
    "text": "Enjeux actuels\n\nPlusieurs problématiques :\n\nModèle entrainé sur les données Sirene 3\nChangement de nomenclature NAF 2008 vers NAF 2025\nExplicabilité du modèle pour les gestionnaires\n\nGroupe de veille n°10 en janvier 📅"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#calendrier-pour-ladoption-de-la-nouvelle-naf",
    "href": "slides/grp-veille-codif-auto-9/index.html#calendrier-pour-ladoption-de-la-nouvelle-naf",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Calendrier pour l’adoption de la nouvelle NAF 🗓️",
    "text": "Calendrier pour l’adoption de la nouvelle NAF 🗓️\n\nVers une adoption transitoire\n2025 ➡️ double codification en NAF 2025\n\nSirus : recodification pour fin 2025\nSirene : Intégration de la NAF 2025 en flux et d’une infrastructure MLOps-compatible\n\n2026 ➡️ amélioration de la codification en NAF 2025\n2027 ➡️ codification en NAF 2025 avec maintien de la codification NAF 2008"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#naf-2025-quels-changements",
    "href": "slides/grp-veille-codif-auto-9/index.html#naf-2025-quels-changements",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "NAF 2025 : quels changements ?",
    "text": "NAF 2025 : quels changements ?\n\nAu niveau 5 : 746 sous classes contre 732 auparavant\nPrincipalement des éclatements au niveau de la classe (niveau 4) … mais pas que !\n551 classes univoques, correspondance 1-pour-1 ➡️ cas idéal ! 👌"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#naf-2025-les-cas-multivoques",
    "href": "slides/grp-veille-codif-auto-9/index.html#naf-2025-les-cas-multivoques",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "NAF 2025 : les cas multivoques",
    "text": "NAF 2025 : les cas multivoques\n\n181 classes multivoques, correspondance 1-pour-N ➡️ cas problématiques ! 🚩\nBesoin d’un expert pour déterminer le nouveau code\n\n\n\n\nAfficher la distribution des codes multivoques\n\n\n\n\n1-to-N\n# occurence\n\n\n\n\n2\n109\n\n\n3\n30\n\n\n4\n24\n\n\n5\n6\n\n\n6\n4\n\n\n8\n1\n\n\n9\n2\n\n\n21\n1\n\n\n27\n1\n\n\n36\n1\n\n\n38\n2"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#enjeux-et-besoins-multiples",
    "href": "slides/grp-veille-codif-auto-9/index.html#enjeux-et-besoins-multiples",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Enjeux et besoins multiples",
    "text": "Enjeux et besoins multiples\n\nBesoin de recoder le stock de liasse de Sirene ➡️ + \\(14\\) millions…\nPouvoir coder le flux en NAF 2025 ➡️ entraîner un modèle ➡️ besoin d’avoir un stock…\nModèle en NAF 2008 entrainé sur + 10 millions\nPerformance de fastText très dépendant du nombre de données d’entraînement"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#données-à-disposition",
    "href": "slides/grp-veille-codif-auto-9/index.html#données-à-disposition",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Données à disposition",
    "text": "Données à disposition\n\nStock Sirene 3 : \\(~10\\) millions obs. mais peu adaptées aux nouvelles données\nStock Sirene 4 : \\(~2.7\\) millions obs.\n\nUnivoques : \\(1.3\\) millions obs. et 504 sous-classes\nMultivoques : \\(1.4\\) millions obs. et 177 sous-classes\n\nCampagne d’annotation manuelle indispensable"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#campagne-dannotation",
    "href": "slides/grp-veille-codif-auto-9/index.html#campagne-dannotation",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Campagne d’annotation",
    "text": "Campagne d’annotation\n\nLancement d’une campagne d’annotation depuis mi-2024\nPlateforme développée par l’équipe métier 🤔\nFocus sur les données multivoques uniques\n🎯 Objectif double :\n\nAttribuer un code NAF 2025 🚀\nVérifier la qualité du code NAF 2008 🗸\n\n\nAujourd’hui, \\(~27k\\) données annotées… insuffisant !"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#méthodologie",
    "href": "slides/grp-veille-codif-auto-9/index.html#méthodologie",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Méthodologie",
    "text": "Méthodologie\n\n🎯 Objectif : Reconstruire un jeu d’entraînement le plus exhaustif possible\nExpérimentation one-shot ➡️ pas de contrainte de reproductibilité … en production\nUtilisation de LLMs pour générer des annotations en NAF 2025\nDonnées à disposition :\n\nStock Sirene 4 (\\(~2.7\\) millions d’observations)\nTable de passage réalisée par les experts APE\nNotes explicatives de la NAF 2025\nAnnotations manuelles (\\(~27k\\) observations)"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#méthodologie-1",
    "href": "slides/grp-veille-codif-auto-9/index.html#méthodologie-1",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Méthodologie",
    "text": "Méthodologie"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#tirer-profit-des-llms",
    "href": "slides/grp-veille-codif-auto-9/index.html#tirer-profit-des-llms",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Tirer profit des LLMs",
    "text": "Tirer profit des LLMs\n\nRetrieval Augmented Generation (RAG) vs fine-tunning\n2 possibilités :\n\nRAG avec les notes explicatives\n\n\nPas encore testé 📝\n\n\nPseudo-RAG :\n\n\nRetriever manuel utilisant la table de passage\n\n💡 Idée générale ➡️ Fournir les données essentielles au LLM pour convertir les codes NAF 2008 vers 2025\n\n\n\n\nAvertissement\n\n\nL’idée n’est pas de construire un classifier, seulement créer des annotations."
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#le-prompting",
    "href": "slides/grp-veille-codif-auto-9/index.html#le-prompting",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Le prompting",
    "text": "Le prompting\n\nPrompt système identique pour toutes les observations\n\n\nAfficher le prompt sytème\n\nTu es un expert de la Nomenclature statistique des Activités économiques dans la Communauté Européenne (NACE). Tu es chargé de réaliser le changement de nomenclature. Ta mission consiste à attribuer un code NACE 2025 à une entreprise, en t'appuyant sur le descriptif de son activité et à partir d'une liste de codes proposés (identifiée à partir de son code NACE 2008 existant). Voici les instructions à suivre :\n1. Analyse la description de l'activité principale de l'entreprise et le code NACE 2008 fourni par l'utilisateur.\n2. À partir de la liste des codes NACE 2025 disponible, identifie la catégorie la plus appropriée qui correspond à l'activité principale de l'entreprise.\n3. Retourne le code NACE 2025 au format JSON comme spécifié par l'utilisateur. Si la description de l'activité de l'entreprise n'est pas suffisamment précise pour identifier un code NACE 2025 adéquat, retourne `null` dans le JSON.\n4. Évalue la cohérence entre le code NACE 2008 fourni et la description de l'activité de l'entreprise. Si le code NACE 2008 ne semble pas correspondre à cette description, retourne `False` dans le champ `nace08_valid` du JSON. Note que si tu arrives à classer la description de l'activité de l'entreprise dans un code NACE 2025, le champ `nace08_valid` devrait `True`, sinon il y a incohérence.\n5. Réponds seulement avec le JSON complété aucune autres information ne doit être retourné.\n\nUn prompt spécifique pour chaque observations comprenant :\n\nle libellé de l’activité principale de l’entreprise\nl’ancien code NAF 2008 connu\nLa liste des codes possibles issues du mapping avec leurs notes explicatives\n\nUne instruction sur le format de réponse attendu"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#qualifier-la-réponse-générée",
    "href": "slides/grp-veille-codif-auto-9/index.html#qualifier-la-réponse-générée",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Qualifier la réponse générée",
    "text": "Qualifier la réponse générée\n\nTendance des LLMs a être très volubiles…\nConstruction d’une réponse type, claire et brèves dans un format spécifique\nFormat JSON est le plus abondamment utilisé dans l’écosystème\n\n\n\nAfficher un exemple de réponse attendue\n\n{\n    \"codable\": true,\n    \"nace_2008_valid\": true,\n    \"nace2025\": \"0147J\" \n}\n\n\nParsing de la réponse :\n\nVérification du format\nContrôle des hallucinations"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#llms-utilisés",
    "href": "slides/grp-veille-codif-auto-9/index.html#llms-utilisés",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "LLMs utilisés",
    "text": "LLMs utilisés\n\n\n\n\n\n\n\n\n\n\nModèle\nTaille\nVitesse d’inférence\nPerformance\nCaractéristique\n\n\n\n\nQwen 2.5\n32B\nLent\nBonnes performances\nTrès restrictif\n\n\nMinistral\n8B\nExtrêmement rapide\nTrès raisonnable\nPas restrictif\n\n\nMistal Small\n44B\nLent\nBonnes performances\nAssez restrictif\n\n\nLlama 3.1\n70B (quantisé)\nExtrêmement lent\nTrès bonnes performances\nAssez restrictif"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#le-fléau-de-lévaluation",
    "href": "slides/grp-veille-codif-auto-9/index.html#le-fléau-de-lévaluation",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Le fléau de l’évaluation",
    "text": "Le fléau de l’évaluation\n\n❓ Question cruciale :\n\nComment évaluer un LLM ?\nClassification ➡️ plus facile, vraiment ?\nComplexité de la nomenclature\n\nUtilisation des \\(27k\\) annotations comme ground truth 🥇\n3 métriques de performances :\n\nPrécision totale\nPrécision parmi les “codables”\nPrécision “LLM” (erreurs imputables à la génération seulement)"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#performance-des-modèles",
    "href": "slides/grp-veille-codif-auto-9/index.html#performance-des-modèles",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Performance des modèles",
    "text": "Performance des modèles"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#reconstruction-du-jeu-multivoques",
    "href": "slides/grp-veille-codif-auto-9/index.html#reconstruction-du-jeu-multivoques",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Reconstruction du jeu multivoques",
    "text": "Reconstruction du jeu multivoques\n\n💡Principe : considérer les LLMs comme des annotateurs classiques ➡️ X-annotation\n❓Peut-on améliorer performances en mixant les résultats de chaque modèles ?\nConstruction de 3 annotations supplémentaires\n\nChoix en cascade (un modèle en priorité)\nChoix par vote à la majorité\nChoix par vote pondéré"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#combinaison-des-annotations",
    "href": "slides/grp-veille-codif-auto-9/index.html#combinaison-des-annotations",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Combinaison des annotations",
    "text": "Combinaison des annotations"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#ré-entrainement-en-naf-2025",
    "href": "slides/grp-veille-codif-auto-9/index.html#ré-entrainement-en-naf-2025",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Ré-entrainement en NAF 2025",
    "text": "Ré-entrainement en NAF 2025\n\nReconstruction du stock Sirene 4 en NAF 2025 (\\(~2\\) millions d’observations)\nDistribution des données quasi-inchangées\nUtilisation de nouvelles variables propres à Sirene 4\nPerformances similaires au modèle en NAF 2008"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#ré-entrainement-en-naf-2025-1",
    "href": "slides/grp-veille-codif-auto-9/index.html#ré-entrainement-en-naf-2025-1",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Ré-entrainement en NAF 2025",
    "text": "Ré-entrainement en NAF 2025"
  },
  {
    "objectID": "slides/grp-veille-codif-auto-9/index.html#le-modèle-naf-2025",
    "href": "slides/grp-veille-codif-auto-9/index.html#le-modèle-naf-2025",
    "title": "Travaux sur le passage de la nomenclature NAF2008 Rev2.1 à la NAF2025",
    "section": "Le modèle NAF 2025",
    "text": "Le modèle NAF 2025\n\nviewof activite = Inputs.text(\n  {label: '', value: 'coiffeur', width: 800}\n)\n\nviewof type_form = Inputs.text(\n  {label: 'Type de la liasse', value: 'X', width: 80}\n)\nurlApe = `https://codification-ape-dev.lab.sspcloud.fr/predict?description_activity=${activite}%20&type_form=${type_form}&event=01P&nb_echos_max=3&prob_min=0.0009`\n\nd3.json(urlApe).then( res =&gt; {\n  var IC, results;\n  ( {IC, ...results} = res )\n\n  IC = parseFloat(IC)\n\n  const rows = Object.values(results).map( obj =&gt; {\n    return `\n    &lt;tr&gt;\n      &lt;td&gt;${obj.code} | ${obj.libelle}&lt;/td&gt;\n      &lt;td&gt;${obj.probabilite.toFixed(3)}&lt;/td&gt;\n    &lt;/tr&gt;\n  `\n  }).join('')\n  \n  return html`\n  &lt;table&gt;\n    &lt;caption&gt;\n      Indice de confiance : ${IC.toFixed(3)}\n    &lt;/caption&gt;\n    &lt;tr&gt;\n      &lt;th style=\"text-align:center;\"&gt;Libellé (NAF 2025)&lt;/th&gt;\n      &lt;th&gt;Probabilité&lt;/th&gt;\n    &lt;/tr&gt;\n      ${rows}\n  &lt;/table&gt;`\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { debounce } from \"@mbostock/debouncing-input\""
  }
]